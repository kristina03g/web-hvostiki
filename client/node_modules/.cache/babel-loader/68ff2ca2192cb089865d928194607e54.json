{"ast":null,"code":"import { Encoding } from './encoding';\nimport inArray from '../../common/in-array';\nvar numberRegex = /^\\d+$/;\nvar extend = Object.assign;\nexport var Postnet = function (Encoding) {\n  function Postnet() {\n    Encoding.apply(this, arguments);\n  }\n  if (Encoding) Postnet.__proto__ = Encoding;\n  Postnet.prototype = Object.create(Encoding && Encoding.prototype);\n  Postnet.prototype.constructor = Postnet;\n  Postnet.prototype.initProperties = function initProperties() {\n    Encoding.prototype.initProperties.call(this);\n    extend(this, {\n      name: \"Postnet\",\n      START: \"2\",\n      VALID_CODE_LENGTHS: [5, 9, 11],\n      DIGIT_SEPARATOR: \"-\",\n      characterMap: [\"22111\", \"11122\", \"11212\", \"11221\", \"12112\", \"12121\", \"12211\", \"21112\", \"21121\", \"21211\"]\n    });\n  };\n  Postnet.prototype.initValue = function initValue(value, width, height) {\n    this.height = height;\n    this.width = width;\n    this.baseHeight = height / 2;\n    this.value = value.replace(new RegExp(this.DIGIT_SEPARATOR, \"g\"), \"\");\n    this.pattern = [];\n    this.validate(this.value);\n    this.checkSum = 0;\n    this.setBaseUnit();\n  };\n  Postnet.prototype.addData = function addData() {\n    var this$1 = this;\n    var value = this.value;\n    this.addPattern(this.START);\n    for (var i = 0; i < value.length; i++) {\n      this$1.addCharacter(value.charAt(i));\n    }\n    if (this.options.addCheckSum) {\n      this.addCheckSum();\n    }\n    this.addPattern(this.START);\n    this.pattern.pop();\n  };\n  Postnet.prototype.addCharacter = function addCharacter(character) {\n    var pattern = this.characterMap[character];\n    this.checkSum += parseInt(character, 10);\n    this.addPattern(pattern);\n  };\n  Postnet.prototype.addCheckSum = function addCheckSum() {\n    this.checksum = (10 - this.checkSum % 10) % 10;\n    this.addCharacter(this.checksum);\n  };\n  Postnet.prototype.setBaseUnit = function setBaseUnit() {\n    var startStopLength = 3;\n    this.baseUnit = this.width / ((this.value.length + 1) * 10 + startStopLength + this.quietZoneLength);\n  };\n  Postnet.prototype.validate = function validate(value) {\n    if (!numberRegex.test(value)) {\n      this.invalidCharacterError(value.match(/[^0-9]/)[0]);\n    }\n    if (!inArray(value.length, this.VALID_CODE_LENGTHS)) {\n      throw new Error(\"Invalid value length. Valid lengths for the Postnet symbology are \" + this.VALID_CODE_LENGTHS.join(\",\") + \".\");\n    }\n  };\n  Postnet.prototype.addPattern = function addPattern(pattern) {\n    var this$1 = this;\n    var y1;\n    for (var i = 0; i < pattern.length; i++) {\n      y1 = this$1.height - this$1.baseHeight * pattern.charAt(i);\n      this$1.pattern.push({\n        width: 1,\n        y1: y1,\n        y2: this$1.height\n      });\n      this$1.pattern.push(1);\n    }\n  };\n  return Postnet;\n}(Encoding);","map":null,"metadata":{},"sourceType":"module"}