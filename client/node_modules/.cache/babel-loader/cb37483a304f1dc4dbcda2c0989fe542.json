{"ast":null,"code":"import { Encoding } from './encoding';\nvar extend = Object.assign;\nexport var Ean13 = function (Encoding) {\n  function Ean13() {\n    Encoding.apply(this, arguments);\n  }\n  if (Encoding) Ean13.__proto__ = Encoding;\n  Ean13.prototype = Object.create(Encoding && Encoding.prototype);\n  Ean13.prototype.constructor = Ean13;\n  Ean13.prototype.initProperties = function initProperties() {\n    Encoding.prototype.initProperties.call(this);\n    extend(this, {\n      name: \"EAN 13\",\n      keyTable: ['000000', '001011', '001101', '001110', '010011', '011001', '011100', '010101', '010110', '011010'],\n      characterMap: {\n        digits: [[3, 2, 1, 1], [2, 2, 2, 1], [2, 1, 2, 2], [1, 4, 1, 1], [1, 1, 3, 2], [1, 2, 3, 1], [1, 1, 1, 4], [1, 3, 1, 2], [1, 2, 1, 3], [3, 1, 1, 2]],\n        start: [1, 1, 1],\n        middle: [1, 1, 1, 1, 1]\n      }\n    });\n  };\n  Ean13.prototype.initValue = function initValue(value, width, height) {\n    var valueAsString = String(value);\n    if (valueAsString.length !== 12 || /\\D/.test(valueAsString)) {\n      throw new Error('The value of the \"EAN13\" encoding should be 12 symbols');\n    }\n    this.pattern = [];\n    this.options.height = height;\n    this.baseUnit = width / (95 + this.quietZoneLength);\n    this.value = valueAsString;\n    this.checksum = this.calculateChecksum();\n    this.leftKey = valueAsString[0];\n    this.leftPart = valueAsString.substr(1, 6);\n    this.rightPart = valueAsString.substr(7) + this.checksum;\n  };\n  Ean13.prototype.addData = function addData() {\n    this.addPieces(this.characterMap.start);\n    this.addSide(this.leftPart, this.leftKey);\n    this.addPieces(this.characterMap.middle);\n    this.addSide(this.rightPart);\n    this.addPieces(this.characterMap.start);\n  };\n  Ean13.prototype.addSide = function addSide(leftPart, key) {\n    var this$1 = this;\n    for (var i = 0; i < leftPart.length; i++) {\n      if (key && parseInt(this$1.keyTable[key].charAt(i), 10)) {\n        this$1.addPieces(Array.prototype.slice.call(this$1.characterMap.digits[leftPart.charAt(i)]).reverse(), true);\n      } else {\n        this$1.addPieces(this$1.characterMap.digits[leftPart.charAt(i)], true);\n      }\n    }\n  };\n  Ean13.prototype.addPieces = function addPieces(arrToAdd, limitedHeight) {\n    var this$1 = this;\n    for (var i = 0; i < arrToAdd.length; i++) {\n      if (limitedHeight) {\n        this$1.pattern.push({\n          y1: 0,\n          y2: this$1.options.height * 0.95,\n          width: arrToAdd[i]\n        });\n      } else {\n        this$1.pattern.push(arrToAdd[i]);\n      }\n    }\n  };\n  Ean13.prototype.calculateChecksum = function calculateChecksum() {\n    var odd = 0,\n      even = 0,\n      value = this.value.split(\"\").reverse().join(\"\");\n    for (var i = 0; i < value.length; i++) {\n      if (i % 2) {\n        even += parseInt(value.charAt(i), 10);\n      } else {\n        odd += parseInt(value.charAt(i), 10);\n      }\n    }\n    var checksum = (10 - (3 * odd + even) % 10) % 10;\n    return checksum;\n  };\n  return Ean13;\n}(Encoding);","map":null,"metadata":{},"sourceType":"module"}