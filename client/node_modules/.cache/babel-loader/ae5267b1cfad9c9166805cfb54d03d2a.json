{"ast":null,"code":"import { Class, addClass, deepExtend, defined } from '../../common';\nimport { Extent } from './../extent';\nimport { getSupportedFeatures } from '../utils';\nexport var Layer = function (Class) {\n  function Layer(map, options) {\n    Class.call(this);\n    this.support = getSupportedFeatures();\n    this._initOptions(options);\n    this.map = map;\n    var element = document.createElement(\"div\");\n    addClass(element, \"k-layer\");\n    element.style.zIndex = this.options.zIndex;\n    element.style.opacity = this.options.opacity;\n    this.element = element;\n    map.scrollElement.appendChild(this.element);\n    this._beforeReset = this._beforeReset.bind(this);\n    this._reset = this._reset.bind(this);\n    this._resize = this._resize.bind(this);\n    this._panEnd = this._panEnd.bind(this);\n    this._activate();\n    this._updateAttribution();\n  }\n  if (Class) Layer.__proto__ = Class;\n  Layer.prototype = Object.create(Class && Class.prototype);\n  Layer.prototype.constructor = Layer;\n  Layer.prototype.destroy = function destroy() {\n    this._deactivate();\n  };\n  Layer.prototype._initOptions = function _initOptions(options) {\n    this.options = deepExtend({}, this.options, options);\n  };\n  Layer.prototype.show = function show() {\n    this.reset();\n    this._activate();\n    this._applyExtent(true);\n  };\n  Layer.prototype.hide = function hide() {\n    this._deactivate();\n    this._setVisibility(false);\n  };\n  Layer.prototype.reset = function reset() {\n    this._beforeReset();\n    this._reset();\n  };\n  Layer.prototype._reset = function _reset() {\n    this._applyExtent();\n  };\n  Layer.prototype._beforeReset = function _beforeReset() {};\n  Layer.prototype._resize = function _resize() {};\n  Layer.prototype._panEnd = function _panEnd() {\n    this._applyExtent();\n  };\n  Layer.prototype._applyExtent = function _applyExtent() {\n    var options = this.options;\n    var zoom = this.map.zoom();\n    var matchMinZoom = !defined(options.minZoom) || zoom >= options.minZoom;\n    var matchMaxZoom = !defined(options.maxZoom) || zoom <= options.maxZoom;\n    var extent = Extent.create(options.extent);\n    var inside = !extent || extent.overlaps(this.map.extent());\n    this._setVisibility(matchMinZoom && matchMaxZoom && inside);\n  };\n  Layer.prototype._setVisibility = function _setVisibility(visible) {\n    this.element.style.display = visible ? '' : 'none';\n  };\n  Layer.prototype._activate = function _activate() {\n    var map = this.map;\n    this._deactivate();\n    map.bind('beforeReset', this._beforeReset);\n    map.bind('reset', this._reset);\n    map.bind('resize', this._resize);\n    map.bind('panEnd', this._panEnd);\n  };\n  Layer.prototype._deactivate = function _deactivate() {\n    var map = this.map;\n    map.unbind('beforeReset', this._beforeReset);\n    map.unbind('reset', this._reset);\n    map.unbind('resize', this._resize);\n    map.unbind('panEnd', this._panEnd);\n  };\n  Layer.prototype._updateAttribution = function _updateAttribution() {\n    var attribution = this.map.attribution;\n    if (attribution) {\n      attribution.add(this.options.attribution);\n    }\n  };\n  Layer.prototype._readData = function _readData() {\n    var data = this.options.data || [];\n    return data;\n  };\n  Layer.prototype._hasData = function _hasData() {\n    return this._data && this._data.length > 0;\n  };\n  Layer.prototype._layerIndex = function _layerIndex() {\n    var layers = this.map.layers || [];\n    return layers.indexOf(this);\n  };\n  return Layer;\n}(Class);","map":null,"metadata":{},"sourceType":"module"}